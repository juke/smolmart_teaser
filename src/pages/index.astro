---
import Layout from '../layouts/Layout.astro';
import { Image } from 'astro:assets';
import background from '../assets/background.png';
import logo from '../assets/logo.png';
import smol2 from '../assets/smol2.png';
import smol3 from '../assets/smol3.png';
import smol4 from '../assets/smol4.png';
import { NavigationMenu } from '../components/ui/navigation-menu';
import Hero from '../components/Hero.astro';

// Welcome to Astro! Wondering what to do next? Check out the Astro documentation at https://docs.astro.build
// Don't want to use any of this? Delete everything in this file, the `assets`, `components`, and `layouts` directories, and start fresh.
---

<Layout title="Smolmart - Community Art Platform">
	<main class="relative tracking-wide">
		<NavigationMenu client:load />

		<!-- Hero Section -->
		<section class="relative min-h-screen overflow-hidden">
			{/* Deep background - blurred glow effect */}
			<div 
				class="absolute inset-0 z-0 scale-110"
				data-scroll
				style="transform: translateY(var(--scroll-offset-slow, 0px));"
			>
				<Image 
					src={background} 
					alt="Smolmart Background" 
					class="w-full h-full object-cover opacity-20 blur-xl"
				/>
			</div>

			{/* Main background layer */}
			<div 
				class="absolute inset-0 z-10"
				data-scroll
				style="transform: translateY(var(--scroll-offset-main, 0px));"
			>
				<div class="absolute inset-0 bg-gradient-to-b from-background via-background/95 to-background/90"></div>
				<Image 
					src={background} 
					alt="Smolmart Background" 
					class="w-full h-full object-cover opacity-30"
				/>
			</div>

			{/* Vignette overlay for depth */}
			<div class="absolute inset-0 z-20 pointer-events-none">
				<div class="absolute inset-0 bg-gradient-to-t from-background via-transparent to-background/30"></div>
				<div class="absolute inset-0 bg-gradient-to-r from-background/30 via-transparent to-background/30"></div>
			</div>

			{/* Content */}
			<div class="relative z-30 container mx-auto px-4 sm:px-6 min-h-screen flex items-center justify-center py-20 sm:py-32">
				<Hero logo={logo} smol2={smol2} smol3={smol3} smol4={smol4} />
			</div>
		</section>
	</main>
</Layout>

<style>
	main {
		width: 100%;
	}
</style>

<script>
	const menuButton = document.getElementById('menuButton');
	const mobileMenu = document.getElementById('mobileMenu');

	if (menuButton && mobileMenu) {
		menuButton.addEventListener('click', () => {
			const isHidden = mobileMenu.style.display === 'none';
			mobileMenu.style.display = isHidden ? 'block' : 'none';
			
			// Update the menu button icon
			const svg = menuButton.querySelector('svg');
			if (svg) {
				if (isHidden) {
					svg.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />';
				} else {
					svg.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />';
				}
			}
		});

		// Close mobile menu when clicking outside
		document.addEventListener('click', (event) => {
			if (!menuButton.contains(event.target as Node) && !mobileMenu.contains(event.target as Node)) {
				mobileMenu.style.display = 'none';
				const svg = menuButton.querySelector('svg');
				if (svg) {
					svg.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />';
				}
			}
		});
	}

	let ticking = false;
	
	const handleParallax = () => {
		const scrollY = window.scrollY;
		const elements = document.querySelectorAll('[data-scroll]');
		
		elements.forEach((element) => {
			if (element instanceof HTMLElement) {
				const speed = element.classList.contains('scale-110') ? 0.15 : 0.1;
				const offset = scrollY * speed;
				element.style.setProperty('--scroll-offset-slow', `${offset}px`);
				element.style.setProperty('--scroll-offset-main', `${offset * 0.5}px`);
			}
		});
		
		ticking = false;
	};

	window.addEventListener('scroll', () => {
		if (!ticking) {
			window.requestAnimationFrame(() => {
				handleParallax();
			});
			ticking = true;
		}
	});
</script>
