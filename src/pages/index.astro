---
import Layout from '../layouts/Layout.astro';
import { Image } from 'astro:assets';
import background from '../assets/background.png';
import logo from '../assets/logo.png';
import smol2 from '../assets/smol2.png';
import smol3 from '../assets/smol3.png';
import smol4 from '../assets/smol4.png';
import waitlist_bg from '../assets/waitlist_bg.png';
import Hero from '../components/Hero.astro';
---

<Layout title="Smolmart - Community Art Platform">
	<main class="relative tracking-wide">
		<!-- Hero Section -->
		<section class="relative min-h-screen overflow-hidden">
			{/* Deep background - blurred glow effect */}
			<div 
				class="absolute inset-0 z-0 scale-110"
				data-scroll
				style="transform: translateY(var(--scroll-offset-slow, 0px));"
			>
				<Image 
					src={background} 
					alt="Smolmart Background" 
					class="w-full h-full object-cover opacity-20 blur-xl"
				/>
			</div>

			{/* Main background layer */}
			<div 
				class="absolute inset-0 z-10"
				data-scroll
				style="transform: translateY(var(--scroll-offset-main, 0px));"
			>
				<div class="absolute inset-0 bg-gradient-to-b from-background via-background/95 to-background/90"></div>
				<Image 
					src={background} 
					alt="Smolmart Background" 
					class="w-full h-full object-cover opacity-30"
				/>
			</div>

			{/* Vignette overlay for depth */}
			<div class="absolute inset-0 z-20 pointer-events-none">
				<div class="absolute inset-0 bg-gradient-to-t from-background via-transparent to-background/30"></div>
				<div class="absolute inset-0 bg-gradient-to-r from-background/30 via-transparent to-background/30"></div>
			</div>

			{/* Content */}
			<div class="relative z-30 w-full min-h-screen flex items-center justify-center pt-28 pb-20 sm:pt-32 sm:pb-32">
				<Hero logo={logo} smol2={smol2} smol3={smol3} smol4={smol4} waitlist_bg={waitlist_bg} />
			</div>
		</section>
	</main>
</Layout>

<style>
	main {
		width: 100%;
	}
</style>

<script>
	let ticking = false;
	
	const handleParallax = () => {
		const scrollY = window.scrollY;
		const elements = document.querySelectorAll('[data-scroll]');
		
		elements.forEach((element) => {
			if (element instanceof HTMLElement) {
				const speed = element.classList.contains('scale-110') ? 0.15 : 0.1;
				const offset = scrollY * speed;
				element.style.setProperty('--scroll-offset-slow', `${offset}px`);
				element.style.setProperty('--scroll-offset-main', `${offset * 0.5}px`);
			}
		});
		
		ticking = false;
	};

	window.addEventListener('scroll', () => {
		if (!ticking) {
			window.requestAnimationFrame(() => {
				handleParallax();
			});
			ticking = true;
		}
	});
</script>
